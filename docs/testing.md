# テスト戦略・品質管理ポリシー

このプロジェクトでは、「AI による診断結果を安心して参考にできること」と「将来の機能追加に強いコードベース」をゴールに、次のようなテスト戦略を取っています。

## テストの種類

| 種類 | ツール | 対象 | 目的 |
|------|--------|------|------|
| ユニットテスト | Vitest | `lib/` のスコア計算・回答評価ロジック・APIクライアント | ビジネスロジックが仕様通り・境界値でも壊れないことを保証する |
| カスタムフックテスト | Vitest + Testing Library | `hooks/useDebounce` など | UI ロジック（デバウンス等）が意図したタイミングで動くことを確認する |
| E2Eテスト | Playwright | 診断フロー・スクリーンショット取得 | ホーム → 入力 → 結果表示までの主要シナリオがブラウザ上で動くことを確認する |

## カバレッジ方針

- Vitest のカバレッジ対象を **`lib/` と `hooks/`** に絞り、ドメインロジックと UI ロジックの品質を重点的に可視化しています。
- `npm run test:coverage` 実行時に、`coverage/` 以下に v8 カバレッジレポート（text / json / html）を生成します。
- 現時点では **lib 配下は 60% 超、全体ではおよそ 50% 程度** を確保しており、今後もロジック追加時にテストを増やしていく想定です。

## CI との連携

- GitHub Actions（`.github/workflows/ci.yml`）で、Pull Request ごとに以下を自動実行します。
  - `npm run type-check`（TypeScript の型チェック）
  - `npm run lint`（ESLint）
  - `npm run build`（Next.js ビルド）
  - `npm run test:coverage`（Vitest のカバレッジ付きテスト）
- テスト実行後、`coverage/` ディレクトリを **Artifacts としてアップロード**し、必要に応じて HTML レポートをダウンロードして確認できるようにしています。

## 今後の拡張余地

- `lib/` 以外の API Route（`app/api/**`）に対するユニットテスト・統合テストの追加
- Playwright テストで、主要な結果画面（スキルマップ・求人マッチング・1on1 練習）のスクリーンショットを CI から自動取得して保存する仕組み
- 重要なバグ修正や仕様変更時に、回帰テスト用のテストケースを増やしていく運用


